@using Vehicle_Inspection.Models
@using Vehicle_Inspection.ViewModels

@model Vehicle_Inspection.ViewModels.CreateProfileViewModel

@{
    ViewData["Title"] = "Chỉnh sửa hồ sơ";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Link CSS -->
<link rel="stylesheet" href="~/css/ReceiveProfile/ReceiveProfile.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

<!-- Main Wrapper -->
<div class="receive-profile-wrapper">

    <!-- MAIN CONTENT -->
    <main class="main-content" style="margin: 0 auto; max-width: 1400px;">

        <!-- Loading State -->
        <div id="loading-state" style="display: flex;">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <p>Đang tải dữ liệu...</p>
            </div>
        </div>

        <!-- Page Header -->
        <div class="page-header" id="page-header" style="display: none;">
            <div>
                <h1><i class="bi bi-pencil-square"></i> Chỉnh sửa thông tin chủ xe</h1>
                <p>Cập nhật thông tin chủ sở hữu phương tiện</p>
            </div>
        </div>

        <!-- Breadcrumb -->
        <nav class="breadcrumb-custom" id="breadcrumb" style="display: none;">
            <a href="/"><i class="bi bi-house-door"></i> Trang chủ</a> /
            <a href="/receive-profile">Tiếp nhận hồ sơ</a> /
            <span>Chỉnh sửa</span>
        </nav>

        <!-- DATA DISPLAY -->
        <div id="data-display" style="display: none;">

            <!-- ==================== SECTION: OWNER INFO ==================== -->
            <div class="owner-info-card">
                <div class="owner-card-header">
                    <i class="bi bi-person-circle"></i>
                    <h2>Thông tin chủ xe</h2>
                </div>
                <div class="owner-card-body">
                    <div class="owner-profile-section">
                        <!-- Owner Image -->
                        <div class="owner-image-wrapper">
                            <div id="owner-image-container">
                                <div class="image-placeholder">
                                    <i class="bi bi-person"></i>
                                    <span>HÌNH 3X4</span>
                                </div>
                            </div>
                            <button type="button" class="btn-upload-image" onclick="document.getElementById('owner-image-upload').click()">
                                <i class="bi bi-upload"></i> Đổi ảnh
                            </button>
                            <input type="file" id="owner-image-upload" accept="image/*" style="display: none;" onchange="previewOwnerImage(event)">
                        </div>

                        <!-- Owner Details -->
                        <div class="owner-details">
                            <input type="hidden" id="owner-id" />

                            <div class="detail-row">
                                <div class="detail-item">
                                    <label asp-for="Owner.OwnerType" class="detail-label"></label>
                                    <select asp-for="Owner.OwnerType" id="owner-type" class="detail-input form-select" onchange="toggleOwnerType()">
                                        <option value="PERSON">Cá nhân</option>
                                        <option value="COMPANY">Công ty</option>
                                    </select>
                                    <span asp-validation-for="Owner.OwnerType" class="text-danger"></span>
                                </div>
                                <div class="detail-item">
                                    <label asp-for="Owner.FullName" class="detail-label"></label>
                                    <input asp-for="Owner.FullName" type="text" id="owner-fullname" class="detail-input" placeholder="Nhập họ và tên">
                                    <span asp-validation-for="Owner.FullName" class="text-danger"></span>
                                </div>
                            </div>

                            <!-- Person Info -->
                            <div class="detail-row" id="person-info">
                                <div class="detail-item">
                                    <label asp-for="Owner.CCCD" class="detail-label"></label>
                                    <input asp-for="Owner.CCCD" type="text" id="owner-cccd" class="detail-input" placeholder="Nhập số CCCD/CMND" maxlength="12">
                                    <span asp-validation-for="Owner.CCCD" class="text-danger"></span>
                                </div>
                            </div>

                            <!-- Company Info -->
                            <div class="detail-row" id="company-info" style="display: none;">
                                <div class="detail-item">
                                    <label asp-for="Owner.CompanyName" class="detail-label"></label>
                                    <input asp-for="Owner.CompanyName" type="text" id="owner-company" class="detail-input" placeholder="Nhập tên công ty">
                                    <span asp-validation-for="Owner.CompanyName" class="text-danger"></span>
                                </div>
                                <div class="detail-item">
                                    <label asp-for="Owner.TaxCode" class="detail-label"></label>
                                    <input asp-for="Owner.TaxCode" type="text" id="owner-taxcode" class="detail-input" placeholder="Nhập mã số thuế">
                                    <span asp-validation-for="Owner.TaxCode" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="detail-row">
                                <div class="detail-item">
                                    <label asp-for="Owner.Email" class="detail-label"></label>
                                    <input asp-for="Owner.Email" type="email" id="owner-email" class="detail-input" placeholder="Nhập email">
                                    <span asp-validation-for="Owner.Email" class="text-danger"></span>
                                </div>
                                <div class="detail-item">
                                    <label asp-for="Owner.Phone" class="detail-label"></label>
                                    <input asp-for="Owner.Phone" type="text" id="owner-phone2" class="detail-input" placeholder="Nhập số điện thoại" maxlength="20">
                                    <span asp-validation-for="Owner.Phone" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="detail-row">
                                <div class="detail-item">
                                    <label asp-for="Owner.Address" class="detail-label"></label>
                                    <input asp-for="Owner.Address" type="text" id="owner-address" class="detail-input" placeholder="Nhập địa chỉ">
                                    <span asp-validation-for="Owner.Address" class="text-danger"></span>
                                </div>
                                <div class="detail-item">
                                    <label asp-for="Owner.Province" class="detail-label"></label>
                                    <select asp-for="Owner.Province" id="owner-province" class="detail-input form-select">
                                        <option value="">-- Chọn Tỉnh/Thành phố --</option>
                                    </select>
                                    <span asp-validation-for="Owner.Province" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="detail-row">
                                <div class="detail-item">
                                    <label asp-for="Owner.Ward" class="detail-label"></label>
                                    <select asp-for="Owner.Ward" id="owner-ward" class="detail-input form-select" disabled>
                                        <option value="">-- Chọn Phường/Xã --</option>
                                    </select>
                                    <span asp-validation-for="Owner.Ward" class="text-danger"></span>
                                </div>
                                <div class="detail-item">
                                    <label class="detail-label">Ngày tạo</label>
                                    <input type="text" id="owner-created" class="detail-input" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button type="button" class="btn-save" onclick="saveChanges()">
                    <i class="bi bi-save"></i> Lưu thay đổi
                </button>
                <a href="/receive-profile" class="btn-cancel">
                    <i class="bi bi-x-circle"></i> Hủy bỏ
                </a>
            </div>

        </div>

    </main>
</div>

<!-- Notification Container -->
<div id="notification-container"></div>

<!-- Link JavaScript -->
<script src="~/js/ReceiveProfile/ReceiveProfile.js"></script>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
